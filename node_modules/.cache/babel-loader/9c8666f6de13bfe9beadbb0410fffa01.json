{"ast":null,"code":"import _regeneratorRuntime from\"/Users/shashwatyadav/Desktop/Image-Gallery/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/shashwatyadav/Desktop/Image-Gallery/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/shashwatyadav/Desktop/Image-Gallery/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from'react';import{projectStorage,projectFireStore,timestamp}from'../firebase.js';var useStorage=function useStorage(file){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),progress=_useState2[0],setProgress=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),url=_useState6[0],setUrl=_useState6[1];useEffect(function(){//references\nvar storageRef=projectStorage.ref(file.name);var collectionRef=projectFireStore.collection('images');storageRef.put(file).on('state_changed',function(snap){var percentage=snap.bytesTransferred/snap.totalBytes*100;setProgress(percentage);},function(err){setError(err);},/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var url,createdAt;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return storageRef.getDownloadURL();case 2:url=_context.sent;createdAt=timestamp();collectionRef.add({url:url,createdAt:createdAt});setUrl(url);case 6:case\"end\":return _context.stop();}}},_callee);})));},[file]);return{progress:progress,url:url,error:error};};export default useStorage;","map":{"version":3,"sources":["/Users/shashwatyadav/Desktop/Image-Gallery/src/Hooks/useStorage.js"],"names":["useState","useEffect","projectStorage","projectFireStore","timestamp","useStorage","file","progress","setProgress","error","setError","url","setUrl","storageRef","ref","name","collectionRef","collection","put","on","snap","percentage","bytesTransferred","totalBytes","err","getDownloadURL","createdAt","add"],"mappings":"geAAA,OAAQA,QAAR,CAAiBC,SAAjB,KAAiC,OAAjC,CACA,OAAQC,cAAR,CAAuBC,gBAAvB,CAAwCC,SAAxC,KAAwD,gBAAxD,CAEA,GAAMC,CAAAA,UAAU,CAAC,QAAXA,CAAAA,UAAW,CAACC,IAAD,CAAQ,eACON,QAAQ,CAAC,CAAD,CADf,wCACfO,QADe,eACNC,WADM,8BAECR,QAAQ,CAAC,IAAD,CAFT,yCAEfS,KAFe,eAETC,QAFS,8BAGHV,QAAQ,CAAC,IAAD,CAHL,yCAGfW,GAHe,eAGXC,MAHW,eAKrBX,SAAS,CAAC,UAAI,CACV;AACA,GAAMY,CAAAA,UAAU,CAACX,cAAc,CAACY,GAAf,CAAmBR,IAAI,CAACS,IAAxB,CAAjB,CACA,GAAMC,CAAAA,aAAa,CAACb,gBAAgB,CAACc,UAAjB,CAA4B,QAA5B,CAApB,CAEAJ,UAAU,CAACK,GAAX,CAAeZ,IAAf,EAAqBa,EAArB,CAAwB,eAAxB,CAAwC,SAACC,IAAD,CAAQ,CAC7C,GAAIC,CAAAA,UAAU,CAAED,IAAI,CAACE,gBAAL,CAAsBF,IAAI,CAACG,UAA5B,CAAwC,GAAvD,CACCf,WAAW,CAACa,UAAD,CAAX,CACH,CAHD,CAGE,SAACG,GAAD,CAAO,CACLd,QAAQ,CAACc,GAAD,CAAR,CACH,CALD,sEAKE,2KACiBX,CAAAA,UAAU,CAACY,cAAX,EADjB,QACOd,GADP,eAEOe,SAFP,CAEoBtB,SAAS,EAF7B,CAGCY,aAAa,CAACW,GAAd,CAAkB,CAAChB,GAAG,CAAHA,GAAD,CAAKe,SAAS,CAATA,SAAL,CAAlB,EACAd,MAAM,CAACD,GAAD,CAAN,CAJD,sDALF,IAWH,CAhBQ,CAgBP,CAACL,IAAD,CAhBO,CAAT,CAkBA,MAAO,CAACC,QAAQ,CAARA,QAAD,CAAWI,GAAG,CAAHA,GAAX,CAAgBF,KAAK,CAALA,KAAhB,CAAP,CAEH,CAzBD,CA2BA,cAAeJ,CAAAA,UAAf","sourcesContent":["import {useState,useEffect} from 'react';\nimport {projectStorage,projectFireStore,timestamp} from '../firebase.js';\n\nconst useStorage=(file)=>{\n    const[progress,setProgress]=useState(0);\n    const[error,setError]=useState(null);\n    const[url,setUrl]=useState(null);\n    \n    useEffect(()=>{\n        //references\n        const storageRef=projectStorage.ref(file.name);\n        const collectionRef=projectFireStore.collection('images');\n\n        storageRef.put(file).on('state_changed',(snap)=>{\n           let percentage=(snap.bytesTransferred/snap.totalBytes)*100\n            setProgress(percentage);\n        },(err)=>{\n            setError(err);\n        },async ()=>{\n           const url=await storageRef.getDownloadURL();\n           const createdAt =  timestamp();\n           collectionRef.add({url,createdAt});\n           setUrl(url);\n        })\n    },[file]);\n\n    return {progress, url, error }\n\n}\n\nexport default useStorage;"]},"metadata":{},"sourceType":"module"}